(this["webpackJsonpmtg-montecarlo-sim"]=this["webpackJsonpmtg-montecarlo-sim"]||[]).push([[0],{27:function(e,t,n){e.exports=n(36)},32:function(e,t,n){},33:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var r,a,i,o,u=n(0),c=n.n(u),s=n(23),l=n.n(s),p=(n(32),n(6)),f=n(2),d=(n(33),n(24)),m=n.n(d),g=n(4),h=n(5),v=function(){function e(t,n){Object(g.a)(this,e),this.id=t,this.testType=n,this.hits=0,this.tries=0,this.parentId=void 0}return Object(h.a)(e,[{key:"IsTrue",value:function(e,t){var n=this.runTest(e,t);return n&&this.hits++,this.tries++,n}},{key:"getPercent",value:function(){return this.tries>0?(100*this.hits/this.tries).toFixed(1):"??"}}],[{key:"clone",value:function(e){return e.map((function(e){return e.clone()}))}}]),e}(),b=n(14),y=n(12),O=n(17);!function(e){e[e.Single=0]="Single",e[e.Group=1]="Group"}(r||(r={})),function(e){e.ALL="and",e.ANY="or"}(a||(a={})),function(e){e.GT=">",e.EQ="=",e.LT="<"}(i||(i={})),function(e){e[e.Name=0]="Name"}(o||(o={}));var T=function(){function e(t,n,r){Object(g.a)(this,e),this.red=t,this.green=n,this.blue=r}return Object(h.a)(e,[{key:"interpolateWith",value:function(t,n){return n>1&&(n/=100),new e(this.red+n*(t.red-this.red),this.green+n*(t.green-this.green),this.blue+n*(t.blue-this.blue))}},{key:"toCSS",value:function(){return"rgb(".concat(this.red,",").concat(this.green,",").concat(this.blue,")")}}]),e}(),C=new T(255,0,0),E=new T(0,255,0),j=c.a.createContext({onChangeTestTurn:function(e,t){},onChangeGroupName:function(e,t){},onChangeGroupType:function(e,t){},onChangeSingleTarget:function(e,t){},onChangeSingleCompare:function(e,t){},onChangeSingleAmount:function(e,t){},onDragDrop:function(e,t){},checkCanDrop:function(e,t){return!0}}),S=function(e){function t(e,n){var a;return Object(g.a)(this,t),(a=Object(b.a)(this,Object(y.a)(t).call(this,e,r.Single))).target=n,a.turn=1,a.match=o.Name,a.compare=i.GT,a.amount=1,a}return Object(O.a)(t,e),Object(h.a)(t,[{key:"clone",value:function(){var e=new t(this.id,this.target);return e.parentId=this.parentId,e.turn=this.turn,e.match=this.match,e.compare=this.compare,e.amount=this.amount,e}},{key:"toString",value:function(){switch(this.compare){case i.EQ:return"".concat(this.amount," ").concat(this.target," by T").concat(this.turn);case i.GT:return"".concat(this.amount,"+ ").concat(this.target," by T").concat(this.turn);case i.LT:return"".concat(this.amount,"- ").concat(this.target," by T").concat(this.turn)}}},{key:"runTest",value:function(e){var t=this,n=e.slice(0,6+this.turn),r=!1,a=0;switch(this.match){case o.Name:a=n.filter((function(e){return e.name.includes(t.target)})).length}switch(this.compare){case i.EQ:r=a===this.amount;break;case i.GT:r=a>=this.amount;break;case i.LT:r=a<=this.amount}return r}}]),t}(v),D=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e,r.Group))).groupType=a.ALL,n.name=void 0,n}return Object(O.a)(t,e),Object(h.a)(t,[{key:"clone",value:function(){var e=new t(this.id);return e.parentId=this.parentId,e.groupType=this.groupType,e.name=this.name,e}},{key:"getChildren",value:function(e){var t=this;return e.filter((function(e){return e.parentId===t.id}))}},{key:"toString",value:function(){return void 0!==this.name?"".concat(this.name," [").concat(this.groupType,"]"):"Group ".concat(this.id," [").concat(this.groupType,"]")}},{key:"runTest",value:function(e,t){var n=this.getChildren(t).map((function(n){return n.IsTrue(e,t)}));return this.groupType===a.ANY?n.some((function(e){return e})):n.every((function(e){return e}))}},{key:"getAllDescendants",value:function(e){var n=this.getChildren(e),r=n.flatMap((function(e){return e instanceof t?[e]:[]})).flatMap((function(t){return t.getAllDescendants(e)}));return[].concat(Object(p.a)(n),Object(p.a)(r))}}]),t}(v);function N(e){return JSON.stringify(e)}function k(e){return JSON.parse(e).flatMap((function(e){var t;if(e.testType===r.Single)t=new S(e.id,"");else{if(e.testType!==r.Group)return[];t=new D(e.id)}return Object.assign(t,e),[t]}))}var I=function(){function e(t){Object(g.a)(this,e),this.name=t}return Object(h.a)(e,null,[{key:"parseText",value:function(t){return t.split("\n").flatMap((function(t){var n=t.trim().match(/([0-9]+)[\s]+([\S\s]+)/);if(void 0===n)return[];var r=n;if(3===r.length){var a=Number.parseInt(r[1]),i=new e(r[2]);return new Array(a).fill(i)}return[]}))}}]),e}(),w=n(39),G=n(40),A=function(e){var t=Object(u.useContext)(j),n=Object(w.a)({item:{type:typeof v,id:e.test.id},collect:function(e){return{isDragging:!!e.isDragging()}}}),r=Object(f.a)(n,3),i=r[0].isDragging,o=r[1],s=r[2],l=Object(G.a)({accept:[typeof v],drop:function(n,r){r.didDrop()||r.canDrop()&&t.onDragDrop(n.id,e.test.id)},canDrop:function(n){return t.checkCanDrop(n.id,e.test.id)},collect:function(e){return{isOver:!!e.isOver({shallow:!0}),canDrop:!!e.canDrop()}}}),p=Object(f.a)(l,2),d=p[0],m=d.isOver,g=d.canDrop,h=p[1];return c.a.createElement("div",{className:"group"+(m?" hovered":"")+(g?" canDrop":" noDrop")+(i?" dragging":""),ref:h},c.a.createElement("div",{className:"line groupHeader",ref:s},c.a.createElement("input",{className:"handle",ref:o,readOnly:!0,value:"".concat(e.test.getPercent(),"%"),style:{backgroundColor:C.interpolateWith(E,e.test.hits/e.test.tries).toCSS()}}),c.a.createElement("input",{className:"fill",value:e.test.name,onChange:function(n){return t.onChangeGroupName(e.test.id,n.target.value)},placeholder:"Group Name"}),c.a.createElement("input",{readOnly:!0,disabled:!0,value:"for"}),c.a.createElement("select",{value:e.test.groupType,onChange:function(n){return t.onChangeGroupType(e.test.id,n.target.value)}},c.a.createElement("option",{value:a.ALL},"ALL"),c.a.createElement("option",{value:a.ANY},"ANY")),c.a.createElement("input",{readOnly:!0,disabled:!0,value:"of:"})),c.a.createElement("div",{className:"children"},e.test.getChildren(e.allTests).sort((function(e,t){return e.id-t.id})).map((function(t){return c.a.createElement(L,{key:t.id+"_cmp",test:t,allTests:e.allTests})}))))},M=function(e){var t=Object(u.useContext)(j),n=Object(w.a)({item:{type:typeof v,id:e.test.id},collect:function(e){return{isDragging:!!e.isDragging()}}}),r=Object(f.a)(n,3),a=r[0].isDragging,o=r[1],s=r[2],l=Object(G.a)({accept:[typeof v],drop:function(n,r){r.didDrop()||r.canDrop()&&t.onDragDrop(n.id,e.test.id)},canDrop:function(n){return t.checkCanDrop(n.id,e.test.id)},collect:function(e){return{isOver:!!e.isOver({shallow:!0}),canDrop:!!e.canDrop()}}}),p=Object(f.a)(l,2),d=p[0],m=d.isOver,g=d.canDrop,h=p[1];return c.a.createElement("div",{className:"single"+(m?" hovered":"")+(g?" canDrop":" noDrop")+(a?" dragging":""),ref:h},c.a.createElement("div",{className:"line",ref:s},c.a.createElement("input",{className:"handle",ref:o,readOnly:!0,value:"".concat(e.test.getPercent(),"%"),style:{backgroundColor:C.interpolateWith(E,e.test.hits/e.test.tries).toCSS()}}),c.a.createElement("input",{value:e.test.target,className:"fill",onChange:function(n){return t.onChangeSingleTarget(e.test.id,n.target.value)},placeholder:"Target Card"}),c.a.createElement("select",{value:e.test.compare,onChange:function(n){return t.onChangeSingleCompare(e.test.id,n.target.value)}},c.a.createElement("option",{value:i.GT},"\u2265"),c.a.createElement("option",{value:i.EQ},"="),c.a.createElement("option",{value:i.LT},"\u2264")),c.a.createElement("input",{type:"number",value:e.test.amount,onChange:function(n){return t.onChangeSingleAmount(e.test.id,Number.parseInt(n.target.value))}}),c.a.createElement("input",{readOnly:!0,disabled:!0,value:"by T"}),c.a.createElement("input",{type:"number",value:e.test.turn,onChange:function(n){return t.onChangeTestTurn(e.test.id,Number.parseInt(n.target.value))}})))},L=function(e){return e.test instanceof D?c.a.createElement(A,{test:e.test,allTests:e.allTests}):e.test instanceof S?c.a.createElement(M,{test:e.test}):c.a.createElement("div",null)},x=n(38),B=n(21),H=function(e){var t=Object(G.a)({accept:[typeof v],drop:function(t,n){e.dropHandler(t.id)},collect:function(e){return{isOver:!!e.isOver({shallow:!0})}}}),n=Object(f.a)(t,2),r=n[0].isOver,a=n[1];return c.a.createElement("div",{id:"trash",ref:a,className:r?" hovered":""},"Drop here to delete")};var P=function(e,t){var n=Object(u.useState)((function(){try{return window.localStorage.getItem(e)||t}catch(n){return t}})),r=Object(f.a)(n,2),a=r[0],i=r[1];return[a,function(t){try{var n=t;i(n),localStorage.setItem(e,n)}catch(r){console.log(r)}}]},W=[{id:6,type:r.Group,parent:15,name:"Curve"},{id:1,type:r.Single,target:"Mountain",parent:6,amount:1,turn:1,compare:i.GT},{id:2,type:r.Single,target:"Mountain",parent:6,amount:2,turn:2,compare:i.GT},{id:3,type:r.Single,target:"Mountain",parent:6,amount:3,turn:3,compare:i.GT},{id:4,type:r.Single,target:"Mountain",parent:6,amount:4,turn:4,compare:i.GT},{id:5,type:r.Single,target:"Mountain",parent:6,amount:5,turn:5,compare:i.GT},{id:14,type:r.Group,group:a.ALL,parent:15,name:"Combo Pieces"},{id:7,type:r.Single,turn:4,target:"Fires of Invention",parent:14},{id:8,type:r.Single,turn:5,target:"Purphoros",parent:14},{id:9,type:r.Single,turn:5,target:"Cavalier of Flame",parent:14},{id:10,type:r.Group,group:a.ANY,parent:14,name:"Any 1 extra"},{id:11,type:r.Single,turn:5,target:"Terror",parent:10},{id:12,type:r.Single,turn:5,target:"Drakuseth",parent:10},{id:13,type:r.Single,turn:5,target:"Ilharg",parent:10},{id:15,type:r.Group,group:a.ALL,parent:null,name:"Magical Xmas Land"}].map((function(e){if(e.type===r.Group){var t=new D(e.id);return"number"===typeof e.parent&&(t.parentId=e.parent),void 0!==e.group&&(t.groupType=e.group),t.name=e.name,t}var n=new S(e.id,e.target);return"number"===typeof e.parent&&(n.parentId=e.parent),void 0!==e.amount&&(n.amount=e.amount),void 0!==e.turn&&(n.turn=e.turn),void 0!==e.compare&&(n.compare=e.compare),n})),F=function(){var e=P("deck","28 Mountain (M20) 276\n4 Terror of Mount Velus (THB) 295\n4 Purphoros, Bronze-Blooded (THB) 150\n4 Ilharg, the Raze-Boar (WAR) 133\n4 Cavalier of Flame (M20) 125\n4 Storm's Wrath (THB) 157\n4 Fires of Invention (ELD) 125\n4 Bonecrusher Giant (ELD) 115\n4 Drakuseth, Maw of Flames (M20) 136"),t=Object(f.a)(e,2),n=t[0],r=t[1],a=P("tests",N(W)),i=Object(f.a)(a,2),o=i[0],s=i[1],l=Object(u.useState)(n),d=Object(f.a)(l,2),g=d[0],h=d[1],b=Object(u.useState)(k(o)),y=Object(f.a)(b,2),O=y[0],T=y[1],C=Object(u.useState)(!1),E=Object(f.a)(C,2),w=E[0],G=E[1],A=Object(u.useState)(9999),M=Object(f.a)(A,2),F=M[0],Y=M[1],J=Object(u.useState)(!0),Q=Object(f.a)(J,2),z=Q[0],R=Q[1];console.log(W,N(W));var _=k(N(O));function U(e,t){T((function(n){return n.map((function(n){return n.id===e&&t(n),n}))}))}function V(e,t){T((function(n){return n.map((function(n){return n.id===e&&n instanceof S&&t(n),n}))}))}function X(e,t){T((function(n){return n.map((function(n){return n.id===e&&n instanceof D&&t(n),n}))}))}console.log(_),Object(u.useEffect)((function(){R(!1)}),[O,g]);var $=function(e,t){if(e===t)return!1;var n=O.find((function(t){return t.id===e})),r=O.find((function(e){return e.id===t}));if(n instanceof v&&r instanceof v){if(void 0!==n.parentId&&n.parentId===r.id)return!1;if(void 0!==n.parentId&&n.parentId===r.parentId){var a=O.find((function(e){return e.id===n.parentId}));if(a instanceof D&&2===a.getChildren.length)return!1}if(n instanceof D)if(n.getAllDescendants(O).some((function(e){return e.id===t})))return!1;return!0}return!1},q={onChangeTestTurn:function(e,t){return V(e,(function(e){return e.turn=t}))},onChangeSingleTarget:function(e,t){return V(e,(function(e){return e.target=t}))},onChangeGroupName:function(e,t){return X(e,(function(e){return e.name=t}))},onChangeGroupType:function(e,t){return X(e,(function(e){return e.groupType=t}))},onChangeSingleCompare:function(e,t){return V(e,(function(e){return e.compare=t}))},onChangeSingleAmount:function(e,t){return V(e,(function(e){return e.amount=t}))},onDragDrop:function(e,t){if(console.log("Handlers","Dropped",e,"into",t),!1!==$(e,t)){var n=O.find((function(t){return t.id===e})),r=O.find((function(e){return e.id===t}));if(n instanceof v&&r instanceof v){if(void 0!==n.parentId){var a=O.find((function(e){return e.id===n.parentId}));a instanceof D&&1===a.getChildren(O).length&&T((function(e){return e.filter((function(e){return e.id!==n.parentId}))}))}if(r instanceof S){var i=new D(1+Math.max.apply(Math,Object(p.a)(O.map((function(e){return e.id})))));i.parentId=r.parentId,T((function(e){return[].concat(Object(p.a)(e),[i])})),U(e,(function(e){return e.parentId=i.id})),U(t,(function(e){return e.parentId=i.id}))}r instanceof D&&U(e,(function(e){return e.parentId=r.id}))}}else console.log("Invalid drop")},checkCanDrop:$};function K(){!function(){G(!0);for(var e=v.clone(O),t=e.filter((function(e){return null==e.parentId})),n=I.parseText(g),r=function(r){var a=m.a.shuffle(n);t.forEach((function(t){return t.IsTrue(a,e)}))},a=0;a<9999;a++)r();T(e),G(!1)}()}return c.a.createElement("div",{className:"App",style:{textAlign:"left"}},c.a.createElement("div",{className:"header"}),c.a.createElement("div",{className:"content"},c.a.createElement("div",{id:"deck"},c.a.createElement("div",{className:"line"},c.a.createElement("button",{className:"left fill run",onClick:K,disabled:w},"RUN"),c.a.createElement("input",{type:"number",value:F,onChange:function(e){return Y(Number.parseInt(e.target.value))}}),c.a.createElement("button",{className:"right fill run",onClick:K,disabled:w},"times"),c.a.createElement("div",{className:"horizontalSpacer"}),c.a.createElement("button",{className:"add",onClick:function(){T((function(e){return[].concat(Object(p.a)(e),[new S(1+Math.max.apply(Math,[0].concat(Object(p.a)(e.map((function(e){return e.id}))))),"")])}))}},"Add Condition")),c.a.createElement("em",null,"Deck"),c.a.createElement("textarea",{value:g,onChange:function(e){return h(e.target.value)}}),c.a.createElement("div",{className:"line"},c.a.createElement("button",{id:"save",disabled:z,onClick:function(){r(g),s(N(O)),R(!0)}},"Save"),c.a.createElement(x.a,{backend:B.a},c.a.createElement(H,{dropHandler:function(e){var t=O.find((function(t){return t.id===e}));if(t instanceof S)T((function(e){return e.filter((function(e){return e.id!==t.id}))}));else if(t instanceof D){var n=t.getAllDescendants(O).map((function(e){return e.id})),r=[t.id].concat(Object(p.a)(n));T((function(e){return e.filter((function(e){return!1===r.includes(e.id)}))}))}}})))),c.a.createElement(j.Provider,{value:q},c.a.createElement(x.a,{backend:B.a},c.a.createElement("div",{id:"tests"},O.filter((function(e){return null==e.parentId})).sort((function(e,t){return e.id-t.id})).map((function(e){return c.a.createElement(L,{key:e.id+"_tst",test:e,allTests:O})})))))),c.a.createElement("div",{className:"footer"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.6f781c5f.chunk.js.map