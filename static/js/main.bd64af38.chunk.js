(this["webpackJsonpmtg-montecarlo-sim"]=this["webpackJsonpmtg-montecarlo-sim"]||[]).push([[0],{58:function(e,t,n){e.exports=n(90)},63:function(e,t,n){},65:function(e,t,n){},71:function(e,t){},73:function(e,t){},90:function(e,t,n){"use strict";n.r(t);var a,r,o,u,i=n(0),c=n.n(i),l=n(51),s=n.n(l),p=(n(63),n(9)),f=n(29),d=n.n(f),m=n(2),g=(n(65),n(4)),v=n.n(g),h=n(8),b=n(5),y=function(){function e(t,n){Object(h.a)(this,e),this.id=t,this.testType=n,this.hits=0,this.tries=0,this.parentId=void 0}return Object(b.a)(e,[{key:"IsTrue",value:function(e,t){var n=this.runTest(e,t);return n&&this.hits++,this.tries++,n}},{key:"getPercent",value:function(){return this.tries>0?(100*this.hits/this.tries).toFixed(1):"??"}}],[{key:"clone",value:function(e){return e.map((function(e){return e.clone()}))}}]),e}(),C=n(26),E=n(22),T=n(27);!function(e){e[e.Single=0]="Single",e[e.Group=1]="Group"}(a||(a={})),function(e){e.ALL="and",e.ANY="or"}(r||(r={})),function(e){e.GT=">",e.EQ="=",e.LT="<",e.NE="<>"}(o||(o={})),function(e){e.Name="Name",e.CardType="CardType",e.CMC="CMC",e.Power="Power",e.Toughness="Toughness"}(u||(u={}));var O=function(){function e(t,n,a){Object(h.a)(this,e),this.red=t,this.green=n,this.blue=a}return Object(b.a)(e,[{key:"interpolateWith",value:function(t,n){return n>1&&(n/=100),new e(this.red+n*(t.red-this.red),this.green+n*(t.green-this.green),this.blue+n*(t.blue-this.blue))}},{key:"toCSS",value:function(){return"rgb(".concat(this.red,",").concat(this.green,",").concat(this.blue,")")}}]),e}(),N=new O(255,0,0),S=new O(0,255,0),k=c.a.createContext({onChangeTestTurn:function(e,t){},onChangeGroupName:function(e,t){},onChangeGroupType:function(e,t){},onChangeSingleTarget:function(e,t,n){},onChangeSingleCompare:function(e,t){},onChangeSingleCompareTarget:function(e,t){},onChangeSingleAmount:function(e,t){},onDragDrop:function(e,t){},checkCanDrop:function(e,t){return!0}}),w=function(e){function t(e,n){var r;return Object(h.a)(this,t),(r=Object(C.a)(this,Object(E.a)(t).call(this,e,a.Single))).id=e,r.target=n,r.turn=1,r.match=u.Name,r.compareCards=o.GT,r.compareTarget=o.EQ,r.amount=1,r}return Object(T.a)(t,e),Object(b.a)(t,[{key:"clone",value:function(){var e=new t(this.id,this.target);return Object.assign(e,this),e}},{key:"toString",value:function(){var e="Draw ";switch(this.compareCards){case o.EQ:e+="exactly";break;case o.GT:e+="at least";break;case o.LT:e+="at most"}return e+=" "+this.amount+" cards with "+this.match+" "+this.compareTarget+" "+this.target,e+=" by turn "+this.turn}},{key:"runTest",value:function(e){var t,n=this,a=e.slice(0,6+this.turn),r=!1,i=0,c=Number.parseInt(this.target),l=function(e){return""},s=function(e){return!1},p=function(e){return NaN},f=function(e){return!1};switch(this.match){case u.Name:l=function(e){return e.name},t="string";break;case u.CMC:p=function(e){return e.cmc},t="number";break;case u.CardType:l=function(e){return e.cardType},t="string";break;case u.Power:p=function(e){return e.power},t="number";break;case u.Toughness:p=function(e){return e.toughness},t="number"}switch(this.compareTarget){case o.EQ:s=function(e){return e.includes(n.target)},f=function(e){return e===c};break;case o.NE:s=function(e){return!e.includes(n.target)},f=function(e){return e!==c};break;case o.GT:f=function(e){return e>=c};break;case o.LT:f=function(e){return e<=c}}switch("number"===t?i=a.map(p).filter(f).length:"string"===t&&(i=a.map(l).filter(s).length),this.compareCards){case o.EQ:r=i===this.amount;break;case o.GT:r=i>=this.amount;break;case o.LT:r=i<=this.amount}return r}}]),t}(y),j=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(C.a)(this,Object(E.a)(t).call(this,e,a.Group))).id=e,n.groupType=r.ALL,n.name=void 0,n}return Object(T.a)(t,e),Object(b.a)(t,[{key:"clone",value:function(){var e=new t(this.id);return e.parentId=this.parentId,e.groupType=this.groupType,e.name=this.name,e}},{key:"getChildren",value:function(e){var t=this;return e.filter((function(e){return e.parentId===t.id}))}},{key:"toString",value:function(){return void 0!==this.name?"".concat(this.name," [").concat(this.groupType,"]"):"Group ".concat(this.id," [").concat(this.groupType,"]")}},{key:"runTest",value:function(e,t){var n=this.getChildren(t).map((function(n){return n.IsTrue(e,t)}));return this.groupType===r.ANY?n.some((function(e){return e})):n.every((function(e){return e}))}},{key:"getAllDescendants",value:function(e){var n=this.getChildren(e),a=n.flatMap((function(e){return e instanceof t?[e]:[]})).flatMap((function(t){return t.getAllDescendants(e)}));return[].concat(Object(p.a)(n),Object(p.a)(a))}}]),t}(y);function D(e){return JSON.stringify(e)}var x=n(52),I=function(){function e(){Object(h.a)(this,e)}return Object(b.a)(e,null,[{key:"Save",value:function(e,t){localStorage.setItem(e,t)}},{key:"SaveT",value:function(t,n,a){var r=a(n);e.Save(t,r)}},{key:"Load",value:function(e){return window.localStorage.getItem(e)}},{key:"LoadT",value:function(t,n){var a=e.Load(t);if(null===a)return null;try{return n(a)}catch(r){return console.log(r),null}}}]),e}(),L=function(){function e(t){Object(h.a)(this,e),this.name=t,this.cardSet=void 0,this.cardNumber=void 0,this.cmc=Number.NaN,this.cardType="",this.power=Number.NaN,this.toughness=Number.NaN,this.oracleText="",this.manaCost=""}return Object(b.a)(e,[{key:"getLSKey",value:function(){return"Card|"+this.name}}]),Object(b.a)(e,null,[{key:"parseLine",value:function(t){var n=t.trim().match(e.cardRegEx);if(void 0===n||null===n)return[0,null];var a=n;if(a.length>2){var r=Number.parseInt(a[1]),o=new e(a[2].trim());return a.length>3&&void 0!==a[3]&&(o.cardSet=a[3].replace("(","").replace(")","")),a.length>4&&void 0!==a[4]&&(o.cardNumber=Number.parseInt(a[4])),[r,o]}return[0,null]}},{key:"parseDeck",value:function(t){return t.split("\n").flatMap((function(t){var n=e.parseLine(t),a=Object(m.a)(n,2),r=a[0],o=a[1];return o instanceof e?new Array(r).fill(o):[]}))}},{key:"fetchCardInfo",value:function(t){return new Promise((function(n,a){var r=I.LoadT(t.getLSKey(),e.fromJSON);null==r?x.getCardByName(t.name,!0).then((function(a){var r=new e(a.name);r.cardSet=a.set.toUpperCase(),r.cardNumber=a.collector_number?Number.parseInt(a.collector_number):t.cardNumber,r.cardType=a.type_line,r.cmc=a.cmc,r.manaCost=a.mana_cost,r.power=a.power?Number.parseInt(a.power):Number.NaN,r.toughness=a.toughness?Number.parseInt(a.toughness):Number.NaN,r.oracleText=a.oracle_text||"",I.SaveT(t.getLSKey(),r,e.toJSON),r.getLSKey()!==t.getLSKey()&&I.SaveT(r.getLSKey(),r,e.toJSON),n(r)}),(function(e){console.log("error fetching",t,"->",e),a(e)})):n(r)}))}},{key:"prefetchDeck",value:function(t){var n=v.a.uniqBy(e.parseDeck(t),(function(e){return e.name}));return Promise.all(n.map(e.fetchCardInfo))}},{key:"toJSON",value:function(e){return JSON.stringify(e)}},{key:"fromJSON",value:function(t){var n=JSON.parse(t),a=new e(n.name);return Object.assign(a,n),a}}]),e}();L.cardRegEx=/([0-9]+)\s?([^(]+)\s?(\([A-Z]{3}\))?\s?([0-9]+)?/;var M=n(94),G=n(93),A=function(e){var t=Object(i.useContext)(k),n=Object(M.a)({item:{type:typeof y,id:e.test.id},collect:function(e){return{isDragging:!!e.isDragging()}}}),a=Object(m.a)(n,3),o=a[0].isDragging,u=a[1],l=a[2],s=Object(G.a)({accept:[typeof y],drop:function(n,a){a.didDrop()||a.canDrop()&&t.onDragDrop(n.id,e.test.id)},canDrop:function(n){return t.checkCanDrop(n.id,e.test.id)},collect:function(e){return{isOver:!!e.isOver({shallow:!0}),canDrop:!!e.canDrop()}}}),p=Object(m.a)(s,2),f=p[0],d=f.isOver,g=f.canDrop,v=p[1];return c.a.createElement("div",{className:"group"+(d?" hovered":"")+(g?" canDrop":" noDrop")+(o?" dragging":""),ref:v},c.a.createElement("div",{className:"line groupHeader",ref:l},c.a.createElement("input",{className:"handle",ref:u,readOnly:!0,value:"".concat(e.test.getPercent(),"%"),style:{backgroundColor:N.interpolateWith(S,e.test.hits/e.test.tries).toCSS()}}),c.a.createElement("input",{className:"fill",value:e.test.name,onChange:function(n){return t.onChangeGroupName(e.test.id,n.target.value)},placeholder:"Group Name"}),c.a.createElement("input",{readOnly:!0,disabled:!0,value:"for"}),c.a.createElement("select",{value:e.test.groupType,onChange:function(n){return t.onChangeGroupType(e.test.id,n.target.value)}},c.a.createElement("option",{value:r.ALL},"ALL"),c.a.createElement("option",{value:r.ANY},"ANY")),c.a.createElement("input",{readOnly:!0,disabled:!0,value:"of:"})),c.a.createElement("div",{className:"children"},e.test.getChildren(e.allTests).sort((function(e,t){return e.id-t.id})).map((function(t){return c.a.createElement(J,{key:t.id+"_cmp",test:t,allTests:e.allTests,cards:e.cards})}))))},P=function(e){var t=Object(i.useContext)(k),n=Object(M.a)({item:{type:typeof y,id:e.test.id},collect:function(e){return{isDragging:!!e.isDragging()}}}),a=Object(m.a)(n,3),r=a[0].isDragging,l=a[1],s=a[2],p=Object(G.a)({accept:[typeof y],drop:function(n,a){a.didDrop()||a.canDrop()&&t.onDragDrop(n.id,e.test.id)},canDrop:function(n){return t.checkCanDrop(n.id,e.test.id)},collect:function(e){return{isOver:!!e.isOver({shallow:!0}),canDrop:!!e.canDrop()}}}),f=Object(m.a)(p,2),d=f[0],g=d.isOver,h=d.canDrop,b=f[1],C=e.cards.map((function(e){return e.name})).sort().map((function(e){return{value:u.Name+":"+e,text:e}})),E=v.a.uniq(e.cards.flatMap((function(e){var t;return null===(t=e.cardType)||void 0===t?void 0:t.split(/[\s/\W]+/)})).filter((function(e){return void 0!==e})).map((function(e){return e}))).map((function(e){return{value:u.CardType+":"+e,text:e}})),T=v.a.uniq(e.cards.map((function(e){return e.cmc}))).filter((function(e){return null!==e&&void 0!==e})).sort().map((function(e){return{value:u.CMC+":"+e,text:"CMC = ".concat(e)}})),O=v.a.uniq(e.cards.map((function(e){return e.power}))).filter((function(e){return null!==e&&void 0!==e})).sort().map((function(e){return{value:u.Power+":"+e,text:"Power = ".concat(e)}})),w=v.a.uniq(e.cards.map((function(e){return e.toughness}))).filter((function(e){return null!==e&&void 0!==e})).sort().map((function(e){return{value:u.Toughness+":"+e,text:"Toughness = ".concat(e)}})),j=e.test.match+":"+e.test.target;return c.a.createElement("div",{className:"single"+(g?" hovered":"")+(h?" canDrop":" noDrop")+(r?" dragging":""),ref:b},c.a.createElement("div",{className:"line",ref:s},c.a.createElement("input",{className:"handle",ref:l,readOnly:!0,value:"".concat(e.test.getPercent(),"%"),style:{backgroundColor:N.interpolateWith(S,e.test.hits/e.test.tries).toCSS()}}),c.a.createElement("select",{value:j,className:"fill",onChange:function(n){var a=n.target.value.split(":"),r=Object(m.a)(a,2),o=r[0],u=r[1],i=o;t.onChangeSingleTarget(e.test.id,u,i)}},c.a.createElement("option",{defaultChecked:!0},"Select a condition..."),c.a.createElement("optgroup",{label:"Cards with name..."},C.map((function(e){return c.a.createElement("option",{value:e.value,key:e.value},e.text)}))),c.a.createElement("optgroup",{label:"Cards with type..."},E.map((function(e){return c.a.createElement("option",{value:e.value,key:e.value},e.text)}))),c.a.createElement("optgroup",{label:"Cards with CMC..."},T.map((function(e){return c.a.createElement("option",{value:e.value,key:e.value},e.text)}))),c.a.createElement("optgroup",{label:"Cards with Power..."},O.map((function(e){return c.a.createElement("option",{value:e.value,key:e.value},e.text)}))),c.a.createElement("optgroup",{label:"Cards with Toughness..."},w.map((function(e){return c.a.createElement("option",{value:e.value,key:e.value},e.text)})))),c.a.createElement("select",{value:e.test.compareCards,onChange:function(n){return t.onChangeSingleCompare(e.test.id,n.target.value)}},c.a.createElement("option",{value:o.GT},"\u2265"),c.a.createElement("option",{value:o.EQ},"="),c.a.createElement("option",{value:o.LT},"\u2264")),c.a.createElement("input",{type:"number",value:e.test.amount,onChange:function(n){return t.onChangeSingleAmount(e.test.id,Number.parseInt(n.target.value))}}),c.a.createElement("input",{readOnly:!0,disabled:!0,value:"by T"}),c.a.createElement("input",{type:"number",value:e.test.turn,onChange:function(n){return t.onChangeTestTurn(e.test.id,Number.parseInt(n.target.value))}})))},B=function(e){var t=Object(i.useContext)(k),n=Object(i.useState)(e.test.match),a=Object(m.a)(n,2),r=a[0],l=a[1],s=Object(i.useState)(e.test.target),p=Object(m.a)(s,2),f=p[0],d=p[1];Object(i.useEffect)((function(){t.onChangeSingleTarget(e.test.id,f,r)}),[r,f]);var g=Object(M.a)({item:{type:typeof y,id:e.test.id},collect:function(e){return{isDragging:!!e.isDragging()}}}),h=Object(m.a)(g,3),b=h[0].isDragging,C=h[1],E=h[2],T=Object(G.a)({accept:[typeof y],drop:function(n,a){a.didDrop()||a.canDrop()&&t.onDragDrop(n.id,e.test.id)},canDrop:function(n){return t.checkCanDrop(n.id,e.test.id)},collect:function(e){return{isOver:!!e.isOver({shallow:!0}),canDrop:!!e.canDrop()}}}),O=Object(m.a)(T,2),w=O[0],j=w.isOver,D=w.canDrop,x=O[1],I=e.cards.map((function(e){return e.name})).sort().map((function(e){return{value:e,text:e}})),L=v.a.uniq(e.cards.flatMap((function(e){var t;return null===(t=e.cardType)||void 0===t?void 0:t.split(/[\s/\W]+/)})).filter((function(e){return void 0!==e})).map((function(e){return e}))).map((function(e){return{value:e,text:e}})),A=v.a.uniq(e.cards.map((function(e){return e.cmc}))).filter((function(e){return null!==e&&void 0!==e})).sort().map((function(e){return{value:e.toString(),text:"".concat(e)}})),P=v.a.uniq(e.cards.map((function(e){return e.power}))).filter((function(e){return null!==e&&void 0!==e})).sort().map((function(e){return{value:e.toString(),text:"".concat(e)}})),B=v.a.uniq(e.cards.map((function(e){return e.toughness}))).filter((function(e){return null!==e&&void 0!==e})).sort().map((function(e){return{value:e.toString(),text:"".concat(e)}})),J=[];switch(e.test.match){case u.Name:J=I;break;case u.CardType:J=L;break;case u.CMC:J=A;break;case u.Power:J=P;break;case u.Toughness:J=B}var W=[];return W=e.test.match===u.Name||e.test.match===u.CardType?[{value:o.EQ,text:"being"},{value:o.NE,text:"not"}]:[{value:o.EQ,text:"exactly"},{value:o.NE,text:"not"},{value:o.GT,text:"at least"},{value:o.LT,text:"at most"}],c.a.createElement("div",{className:"single"+(j?" hovered":"")+(D?" canDrop":" noDrop")+(b?" dragging":""),ref:x},c.a.createElement("div",{className:"line verbose",ref:E},c.a.createElement("input",{className:"handle",ref:C,readOnly:!0,value:"".concat(e.test.getPercent(),"%"),style:{backgroundColor:N.interpolateWith(S,e.test.hits/e.test.tries).toCSS()}}),c.a.createElement("input",{value:"Draw",readOnly:!0,disabled:!0}),c.a.createElement("select",{value:e.test.compareCards,onChange:function(n){return t.onChangeSingleCompare(e.test.id,n.target.value)}},c.a.createElement("option",{value:o.GT},"at least"),c.a.createElement("option",{value:o.EQ},"exactly"),c.a.createElement("option",{value:o.LT},"at most")),c.a.createElement("select",{value:e.test.amount,onChange:function(n){return t.onChangeSingleAmount(e.test.id,Number.parseInt(n.target.value))}},[0,1,2,3,4,5,6,7,8,9].map((function(e){return c.a.createElement("option",{key:"amount_"+e,value:e},e)}))),c.a.createElement("input",{value:"card"+(1!==e.test.amount?"s":""),readOnly:!0,disabled:!0}),c.a.createElement("select",{value:e.test.match,onChange:function(e){return l(e.target.value)}},c.a.createElement("option",{value:u.Name},"with name"),c.a.createElement("option",{value:u.CardType},"with type"),c.a.createElement("option",{value:u.CMC},"with CMC"),c.a.createElement("option",{value:u.Power},"with Power"),c.a.createElement("option",{value:u.Toughness},"with Toughness")),c.a.createElement("select",{value:e.test.compareTarget,onChange:function(n){return t.onChangeSingleCompareTarget(e.test.id,n.target.value)}},W.map((function(e){return c.a.createElement("option",{key:e.value,value:e.value},e.text)}))),c.a.createElement("select",{value:e.test.target,className:"fill",onChange:function(e){d(e.target.value)}},J.map((function(e){return c.a.createElement("option",{value:e.value,key:e.value},e.text)}))),c.a.createElement("input",{readOnly:!0,disabled:!0,value:"by turn"}),c.a.createElement("select",{value:e.test.turn,onChange:function(n){return t.onChangeTestTurn(e.test.id,Number.parseInt(n.target.value))}},[1,2,3,4,5,6,7,8,9,10].map((function(e){return c.a.createElement("option",{key:"turn_"+e,value:e},e)})))))},J=function(e){return e.test instanceof j?c.a.createElement(A,{test:e.test,allTests:e.allTests,cards:e.cards}):e.test instanceof w&&window.innerWidth<=810?c.a.createElement(P,{test:e.test,cards:e.cards}):e.test instanceof w?c.a.createElement(B,{test:e.test,cards:e.cards}):c.a.createElement("div",null)},W=n(92),q=n(36),Q=n(35),_=function(e){var t=Object(G.a)({accept:[typeof y],drop:function(t,n){e.dropHandler(t.id)},collect:function(e){return{isOver:!!e.isOver({shallow:!0})}}}),n=Object(m.a)(t,2),a=n[0].isOver,r=n[1];return c.a.createElement("div",{id:"trash",ref:r,className:a?" hovered":""},"Drop here to delete")};var F=function(e,t){var n=Object(i.useState)((function(){try{return I.Load(e)||t}catch(n){return t}})),a=Object(m.a)(n,2),r=a[0],o=a[1];return[r,function(t){try{var n=t;o(n),I.Save(e,n)}catch(a){console.log(a)}}]},H=n(56),K=n(55),R=n(34),z=[{id:6,type:a.Group,parent:15,name:"Curve"},{id:1,type:a.Single,target:"Mountain",parent:6,amount:1,turn:1,compare:o.GT},{id:2,type:a.Single,target:"Mountain",parent:6,amount:2,turn:2,compare:o.GT},{id:3,type:a.Single,target:"Mountain",parent:6,amount:3,turn:3,compare:o.GT},{id:4,type:a.Single,target:"Mountain",parent:6,amount:4,turn:4,compare:o.GT},{id:5,type:a.Single,target:"Mountain",parent:6,amount:5,turn:5,compare:o.GT},{id:14,type:a.Group,group:r.ALL,parent:15,name:"Combo Pieces"},{id:7,type:a.Single,turn:4,target:"Fires of Invention",parent:14},{id:8,type:a.Single,turn:5,target:"Purphoros, Bronze-Blooded",parent:14},{id:9,type:a.Single,turn:5,target:"Cavalier of Flame",parent:14},{id:10,type:a.Group,group:r.ANY,parent:14,name:"Any 1 extra"},{id:11,type:a.Single,turn:5,target:"Terror of Mount Velus",parent:10},{id:12,type:a.Single,turn:5,target:"Drakuseth, Maw of Flames",parent:10},{id:13,type:a.Single,turn:5,target:"Ilharg, the Raze-Boar",parent:10},{id:15,type:a.Group,group:r.ALL,parent:null,name:"Magical Xmas Land"}].map((function(e){if(e.type===a.Group){var t=new j(e.id);return"number"===typeof e.parent&&(t.parentId=e.parent),void 0!==e.group&&(t.groupType=e.group),t.name=e.name,t}var n=new w(e.id,e.target);return"number"===typeof e.parent&&(n.parentId=e.parent),void 0!==e.amount&&(n.amount=e.amount),void 0!==e.turn&&(n.turn=e.turn),void 0!==e.compare&&(n.compareCards=e.compare),n})),Y=function(){var e,t=F("deck","28 Mountain (M20) 276\n4 Terror of Mount Velus (THB) 295\n4 Purphoros, Bronze-Blooded (THB) 150\n4 Ilharg, the Raze-Boar (WAR) 133\n4 Cavalier of Flame (M20) 125\n4 Storm's Wrath (THB) 157\n4 Fires of Invention (ELD) 125\n4 Bonecrusher Giant (ELD) 115\n4 Drakuseth, Maw of Flames (M20) 136"),n=Object(m.a)(t,2),r=n[0],o=n[1],u=F("tests",D(z)),l=Object(m.a)(u,2),s=l[0],f=l[1],g=Object(i.useState)(r),h=Object(m.a)(g,2),b=h[0],C=h[1],E=function(e){return d.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:L.prefetchDeck(b).then((function(e){S(e)}));case 1:case"end":return e.stop()}}))},T=Object(i.useState)((function(){return E(),[]})),O=Object(m.a)(T,2),N=O[0],S=O[1],x=Object(i.useState)((e=s,JSON.parse(e).flatMap((function(e){var t;if(e.testType===a.Single)t=new w(e.id,"");else{if(e.testType!==a.Group)return[];t=new j(e.id)}return Object.assign(t,e),[t]})))),I=Object(m.a)(x,2),M=I[0],G=I[1],A=Object(i.useState)(9999),P=Object(m.a)(A,2),B=P[0],Y=P[1],U=Object(i.useState)(!0),V=Object(m.a)(U,2),X=V[0],Z=V[1],$=Object(K.a)((function(){return Object(H.a)(E,500)})),ee=Object(R.useAsync)($,[b]);Object(i.useEffect)((function(){Z(!1)}),[M,b]);var te=function(e,t){G((function(n){return n.map((function(n){return n.id===e&&t(n),n}))}))},ne=function(e,t){G((function(n){return n.map((function(n){return n.id===e&&n instanceof w&&t(n),n}))}))},ae=function(e,t){G((function(n){return n.map((function(n){return n.id===e&&n instanceof j&&t(n),n}))}))},re=function(e,t){if(e===t)return!1;var n=M.find((function(t){return t.id===e})),a=M.find((function(e){return e.id===t}));if(n instanceof y&&a instanceof y){if(void 0!==n.parentId&&n.parentId===a.id)return!1;if(void 0!==n.parentId&&n.parentId===a.parentId){var r=M.find((function(e){return e.id===n.parentId}));if(r instanceof j&&2===r.getChildren.length)return!1}if(n instanceof j)if(n.getAllDescendants(M).some((function(e){return e.id===t})))return!1;return!0}return!1},oe={onChangeTestTurn:function(e,t){return ne(e,(function(e){return e.turn=t}))},onChangeSingleTarget:function(e,t,n){return ne(e,(function(a){console.log(e,n,t),a.target=t,a.match=n||a.match}))},onChangeGroupName:function(e,t){return ae(e,(function(e){return e.name=t}))},onChangeGroupType:function(e,t){return ae(e,(function(e){return e.groupType=t}))},onChangeSingleCompare:function(e,t){return ne(e,(function(e){return e.compareCards=t}))},onChangeSingleAmount:function(e,t){return ne(e,(function(e){return e.amount=t}))},onDragDrop:function(e,t){if(console.log("Handlers","Dropped",e,"into",t),!1!==re(e,t)){var n=M.find((function(t){return t.id===e})),a=M.find((function(e){return e.id===t}));if(n instanceof y&&a instanceof y){if(void 0!==n.parentId){var r=M.find((function(e){return e.id===n.parentId}));r instanceof j&&1===r.getChildren(M).length&&G((function(e){return e.filter((function(e){return e.id!==n.parentId}))}))}if(a instanceof w){var o=new j(1+Math.max.apply(Math,Object(p.a)(M.map((function(e){return e.id})))));o.parentId=a.parentId,G((function(e){return[].concat(Object(p.a)(e),[o])})),te(e,(function(e){return e.parentId=o.id})),te(t,(function(e){return e.parentId=o.id}))}a instanceof j&&te(e,(function(e){return e.parentId=a.id}))}}else console.log("Invalid drop")},checkCanDrop:re,onChangeSingleCompareTarget:function(e,t){console.log(e,t),ne(e,(function(e){return e.compareTarget=t}))}},ue=function(){return ie.execute()},ie=Object(R.useAsync)((function(){var e,t,n,a,r,o,u;return d.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=new Date,i.next=3,d.a.awrap(Promise.all(L.parseDeck(b).map(L.fetchCardInfo)));case 3:for(t=i.sent,console.log("runSim","start"),n=y.clone(M),a=n.filter((function(e){return null==e.parentId})),r=function(e){var r=v.a.shuffle(t);a.forEach((function(e){return e.IsTrue(r,n)}))},o=0;o<9999;o++)r();G(n),u=new Date,console.log("runSim","end",u.getTime()-e.getTime());case 12:case"end":return i.stop()}}))}),[]);return c.a.createElement("div",{className:"App",style:{textAlign:"left"}},c.a.createElement("div",{className:"header"}),c.a.createElement("div",{className:"content"},c.a.createElement("div",{id:"deck"},c.a.createElement("div",{className:"actions line"},c.a.createElement("button",{className:"left fill run",onClick:ue,disabled:ee.loading||ie.loading},"RUN"),c.a.createElement("input",{type:"number",value:B,onChange:function(e){return Y(Number.parseInt(e.target.value))}}),c.a.createElement("button",{className:"right fill run",onClick:ue,disabled:ee.loading||ie.loading},"times"),c.a.createElement("div",{className:"horizontalSpacer"}),c.a.createElement("button",{className:"add fill",onClick:function(){return G((function(e){return[].concat(Object(p.a)(e),[new w(1+Math.max.apply(Math,[0].concat(Object(p.a)(e.map((function(e){return e.id}))))),"")])}))}},"Add Condition")),c.a.createElement("em",null,"Deck"),c.a.createElement("textarea",{value:b,onChange:function(e){C(e.target.value),ee.execute(e.target.value)}}),c.a.createElement("div",{className:"line"},c.a.createElement("button",{id:"save",disabled:X,onClick:function(){o(b),f(D(M)),Z(!0)}},X?"Saved!":"Save"),c.a.createElement(W.a,{backend:q.a,options:Q.a},c.a.createElement(_,{dropHandler:function(e){var t=M.find((function(t){return t.id===e}));if(t instanceof w)G((function(e){return e.filter((function(e){return e.id!==t.id}))}));else if(t instanceof j){var n=t.getAllDescendants(M).map((function(e){return e.id})),a=[t.id].concat(Object(p.a)(n));G((function(e){return e.filter((function(e){return!1===a.includes(e.id)}))}))}}})))),c.a.createElement(k.Provider,{value:oe},c.a.createElement(W.a,{backend:q.a,options:Q.a},c.a.createElement("div",{id:"tests"},M.filter((function(e){return null==e.parentId})).sort((function(e,t){return e.id-t.id})).map((function(e){return c.a.createElement(J,{key:e.id+"_tst",test:e,allTests:M,cards:N})})))))),c.a.createElement("div",{className:"footer"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(Y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[58,1,2]]]);
//# sourceMappingURL=main.bd64af38.chunk.js.map